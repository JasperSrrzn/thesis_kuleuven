

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>torch_geometric.nn &mdash; pytorch_geometric master documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="torch_geometric.data" href="data.html" />
    <link rel="prev" title="Creating your own datasets" href="../notes/create_dataset.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/pyg_logo_text.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                master (1.2.0)
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#c-cuda-extensions-on-macos">C++/CUDA Extensions on macOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#id1">Frequently Asked Questions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notes/introduction.html">Introduction by example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#data-handling-of-graphs">Data handling of graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#common-benchmark-datasets">Common benchmark datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#mini-batches">Mini-batches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#data-transforms">Data transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#learning-methods-on-graphs">Learning methods on graphs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notes/create_gnn.html">Creating message passing networks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/create_gnn.html#the-messagepassing-base-class">The “MessagePassing” base class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/create_gnn.html#implementing-the-gcn-layer">Implementing the GCN layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/create_gnn.html#implementing-the-edge-convolution">Implementing the edge convolution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notes/create_dataset.html">Creating your own datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/create_dataset.html#creating-in-memory-datasets">Creating “in memory datasets”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/create_dataset.html#creating-larger-datasets">Creating “larger” datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/create_dataset.html#frequently-asked-questions">Frequently Asked Questions</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">torch_geometric.nn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.conv.message_passing">Convolutional Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.glob">Global Pooling Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.pool">Pooling Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.unpool">Unpooling Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.data_parallel">DataParallel layers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html">torch_geometric.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">torch_geometric.datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">torch_geometric.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">torch_geometric.utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pytorch_geometric</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>torch_geometric.nn</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/modules/nn.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="torch-geometric-nn">
<h1>torch_geometric.nn<a class="headerlink" href="#torch-geometric-nn" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#module-torch_geometric.nn.conv.message_passing" id="id8">Convolutional Layers</a></li>
<li><a class="reference internal" href="#module-torch_geometric.nn.glob" id="id9">Global Pooling Layers</a></li>
<li><a class="reference internal" href="#module-torch_geometric.nn.pool" id="id10">Pooling Layers</a></li>
<li><a class="reference internal" href="#module-torch_geometric.nn.unpool" id="id11">Unpooling Layers</a></li>
<li><a class="reference internal" href="#module-torch_geometric.nn.models" id="id12">Models</a></li>
<li><a class="reference internal" href="#module-torch_geometric.nn.data_parallel" id="id13">DataParallel layers</a></li>
</ul>
</div>
<div class="section" id="module-torch_geometric.nn.conv.message_passing">
<span id="convolutional-layers"></span><h2><a class="toc-backref" href="#id8">Convolutional Layers</a><a class="headerlink" href="#module-torch_geometric.nn.conv.message_passing" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch_geometric.nn.conv.message_passing.MessagePassing">
<em class="property">class </em><code class="descname">MessagePassing</code><span class="sig-paren">(</span><em>aggr='add'</em>, <em>flow='source_to_target'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.message_passing.MessagePassing" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for creating message passing layers</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}_i^{\prime} = \gamma_{\mathbf{\Theta}} \left( \mathbf{x}_i,
\square_{j \in \mathcal{N}(i)} \, \phi_{\mathbf{\Theta}}
\left(\mathbf{x}_i, \mathbf{x}_j,\mathbf{e}_{i,j}\right) \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(\square\)</span> denotes a differentiable, permutation invariant
function, <em>e.g.</em>, sum, mean or max, and <span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span>
and <span class="math notranslate nohighlight">\(\phi_{\mathbf{\Theta}}\)</span> denote differentiable functions such as
MLPs.
See <a class="reference external" href="https://rusty1s.github.io/pytorch_geometric/build/html/notes/create_gnn.html">here</a> for the accompanying tutorial.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>aggr</strong> (<em>string</em><em>, </em><em>optional</em>) – The aggregation scheme to use
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>).
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>)</li>
<li><strong>flow</strong> (<em>string</em><em>, </em><em>optional</em>) – The flow direction of message passing
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;source_to_target&quot;</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;target_to_source&quot;</span></code>).
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;source_to_target&quot;</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.message_passing.MessagePassing.message">
<code class="descname">message</code><span class="sig-paren">(</span><em>x_j</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.message_passing.MessagePassing.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs messages in analogy to <span class="math notranslate nohighlight">\(\phi_{\mathbf{\Theta}}\)</span>
for each edge in <span class="math notranslate nohighlight">\((i,j) \in \mathcal{E}\)</span>.
Can take any argument which was initially passed to <a class="reference internal" href="#torch_geometric.nn.conv.message_passing.MessagePassing.propagate" title="torch_geometric.nn.conv.message_passing.MessagePassing.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a>.
In addition, features can be lifted to the source node <span class="math notranslate nohighlight">\(i\)</span> and
target node <span class="math notranslate nohighlight">\(j\)</span> by appending <code class="xref py py-obj docutils literal notranslate"><span class="pre">_i</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">_j</span></code> to the
variable name, <em>.e.g.</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_i</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_j</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.message_passing.MessagePassing.propagate">
<code class="descname">propagate</code><span class="sig-paren">(</span><em>edge_index</em>, <em>size=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.message_passing.MessagePassing.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>The initial call to start propagating messages.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>edge_index</strong> (<em>Tensor</em>) – The indices of a general (sparse) assignment
matrix with shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">M]</span></code> (can be directed or
undirected).</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a><em>, </em><em>optional</em>) – The size <code class="xref py py-obj docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">M]</span></code> of the
assignment matrix. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, the size is tried to
get automatically inferrred. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>**kwargs</strong> – Any additional data which is needed to construct messages
and to update node embeddings.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.message_passing.MessagePassing.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>aggr_out</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.message_passing.MessagePassing.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates node embeddings in analogy to
<span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span> for each node
<span class="math notranslate nohighlight">\(i \in \mathcal{V}\)</span>.
Takes in the output of aggregation as first argument and any argument
which was initially passed to <a class="reference internal" href="#torch_geometric.nn.conv.message_passing.MessagePassing.propagate" title="torch_geometric.nn.conv.message_passing.MessagePassing.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a>.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-torch_geometric.nn.conv"></span><dl class="class">
<dt id="torch_geometric.nn.conv.GCNConv">
<em class="property">class </em><code class="descname">GCNConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>improved=False</em>, <em>cached=False</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gcn_conv.html#GCNConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GCNConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The graph convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1609.02907">“Semi-supervised
Classfication with Graph Convolutional Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}^{\prime} = \mathbf{\hat{D}}^{-1/2} \mathbf{\hat{A}}
\mathbf{\hat{D}}^{-1/2} \mathbf{X} \mathbf{\Theta},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\hat{A}} = \mathbf{A} + \mathbf{I}\)</span> denotes the
adjacency matrix with inserted self-loops and
<span class="math notranslate nohighlight">\(\hat{D}_{ii} = \sum_{j=0} \hat{A}_{ij}\)</span> its diagonal degree matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>improved</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the layer computes
<span class="math notranslate nohighlight">\(\mathbf{\hat{A}}\)</span> as <span class="math notranslate nohighlight">\(\mathbf{A} + 2\mathbf{I}\)</span>.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>)</li>
<li><strong>cached</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the layer will cache
the computation of <span class="math notranslate nohighlight">\({\left(\mathbf{\hat{D}}^{-1/2}
\mathbf{\hat{A}} \mathbf{\hat{D}}^{-1/2} \right)}\)</span>.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GCNConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gcn_conv.html#GCNConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GCNConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="torch_geometric.nn.conv.GCNConv.norm">
<em class="property">static </em><code class="descname">norm</code><span class="sig-paren">(</span><em>edge_index</em>, <em>num_nodes</em>, <em>edge_weight</em>, <em>improved=False</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gcn_conv.html#GCNConv.norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GCNConv.norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GCNConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gcn_conv.html#GCNConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GCNConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.ChebConv">
<em class="property">class </em><code class="descname">ChebConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>K</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/cheb_conv.html#ChebConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.ChebConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The chebyshev spectral graph convolutional operator from the
<a class="reference external" href="https://arxiv.org/abs/1606.09375">“Convolutional Neural Networks on Graphs with Fast Localized Spectral
Filtering”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}^{\prime} = \sum_{k=0}^{K-1} \mathbf{Z}^{(k)} \cdot
\mathbf{\Theta}^{(k)}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{Z}^{(k)}\)</span> is computed recursively by</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{Z}^{(0)} &amp;= \mathbf{X}\\\mathbf{Z}^{(1)} &amp;= \mathbf{\hat{L}} \cdot \mathbf{X}\\\mathbf{Z}^{(k)} &amp;= 2 \cdot \mathbf{\hat{L}} \cdot
\mathbf{Z}^{(k-1)} - \mathbf{Z}^{(k-2)}\end{aligned}\end{align} \]</div>
<p>and <span class="math notranslate nohighlight">\(\mathbf{\hat{L}}\)</span> denotes the scaled and normalized Laplacian.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>K</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Chebyshev filter size, <em>i.e.</em> number of hops <span class="math notranslate nohighlight">\(K\)</span>.</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.ChebConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/cheb_conv.html#ChebConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.ChebConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.ChebConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/cheb_conv.html#ChebConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.ChebConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.SAGEConv">
<em class="property">class </em><code class="descname">SAGEConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>normalize=True</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/sage_conv.html#SAGEConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SAGEConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The GraphSAGE operator from the <a class="reference external" href="https://arxiv.org/abs/1706.02216">“Inductive Representation Learning on
Large Graphs”</a> paper</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{\hat{x}}_i &amp;= \mathbf{\Theta} \cdot
\mathrm{mean}_{j \in \mathcal{N(i) \cup \{ i \}}}(\mathbf{x}_j)\\\mathbf{x}^{\prime}_i &amp;= \frac{\mathbf{\hat{x}}_i}
{\| \mathbf{\hat{x}}_i \|_2}.\end{aligned}\end{align} \]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, output features
will not be <span class="math notranslate nohighlight">\(\ell_2\)</span>-normalized.</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.SAGEConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/sage_conv.html#SAGEConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SAGEConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.SAGEConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/sage_conv.html#SAGEConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SAGEConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.GraphConv">
<em class="property">class </em><code class="descname">GraphConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>aggr='add'</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/graph_conv.html#GraphConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GraphConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The graph neural network operator from the <a class="reference external" href="https://arxiv.org/abs/1810.02244">“Weisfeiler and Leman Go
Neural: Higher-order Graph Neural Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \mathbf{\Theta} \mathbf{x}_i +
\sum_{j \in \mathcal{N}(i)} \mathbf{\Theta} \mathbf{x}_j.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>aggr</strong> (<em>string</em>) – The aggregation scheme to use
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>).
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GraphConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/graph_conv.html#GraphConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GraphConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GraphConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/graph_conv.html#GraphConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GraphConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.GatedGraphConv">
<em class="property">class </em><code class="descname">GatedGraphConv</code><span class="sig-paren">(</span><em>out_channels</em>, <em>num_layers</em>, <em>aggr='add'</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gated_graph_conv.html#GatedGraphConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GatedGraphConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The gated graph convolution operator from the <a class="reference external" href="https://arxiv.org/abs/1511.05493">“Gated Graph Sequence
Neural Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{h}_i^{(0)} &amp;= \mathbf{x}_i \, \Vert \, \mathbf{0}\\\mathbf{m}_i^{(l+1)} &amp;= \sum_{j \in \mathcal{N}(i)} \mathbf{\Theta}
\cdot \mathbf{h}_j^{(l)}\\\mathbf{h}_i^{(l+1)} &amp;= \textrm{GRU} (\mathbf{m}_i^{(l+1)},
\mathbf{h}_i^{(l)})\end{aligned}\end{align} \]</div>
<p>up to representation <span class="math notranslate nohighlight">\(\mathbf{h}_i^{(L)}\)</span>.
The number of input channels of <span class="math notranslate nohighlight">\(\mathbf{x}_i\)</span> needs to be less or
equal than <code class="xref py py-obj docutils literal notranslate"><span class="pre">out_channels</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The sequence length <span class="math notranslate nohighlight">\(L\)</span>.</li>
<li><strong>aggr</strong> (<em>string</em>) – The aggregation scheme to use
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>).
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GatedGraphConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gated_graph_conv.html#GatedGraphConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GatedGraphConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GatedGraphConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gated_graph_conv.html#GatedGraphConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GatedGraphConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.GATConv">
<em class="property">class </em><code class="descname">GATConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>heads=1</em>, <em>concat=True</em>, <em>negative_slope=0.2</em>, <em>dropout=0</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gat_conv.html#GATConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GATConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The graph attentional operator from the <a class="reference external" href="https://arxiv.org/abs/1710.10903">“Graph Attention Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \alpha_{i,i}\mathbf{\Theta}\mathbf{x}_{i} +
\sum_{j \in \mathcal{N}(i)} \alpha_{i,j}\mathbf{\Theta}\mathbf{x}_{j},\]</div>
<p>where the attention coefficients <span class="math notranslate nohighlight">\(\alpha_{i,j}\)</span> are computed as</p>
<div class="math notranslate nohighlight">
\[\alpha_{i,j} =
\frac{
\exp\left(\mathrm{LeakyReLU}\left(\mathbf{a}^{\top}
[\mathbf{\Theta}\mathbf{x}_i \, \Vert \, \mathbf{\Theta}\mathbf{x}_j]
\right)\right)}
{\sum_{k \in \mathcal{N}(i) \cup \{ i \}}
\exp\left(\mathrm{LeakyReLU}\left(\mathbf{a}^{\top}
[\mathbf{\Theta}\mathbf{x}_i \, \Vert \, \mathbf{\Theta}\mathbf{x}_k]
\right)\right)}.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>heads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of multi-head-attentions.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>concat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the multi-head</li>
<li><strong>are averaged instead of concatenated.</strong><strong> (</strong><strong>default</strong> (<em>attentions</em>) – <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
<li><strong>negative_slope</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – LeakyReLU angle of the negative
slope. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0.2</span></code>)</li>
<li><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Dropout probability of the normalized
attention coefficients which exposes each node to a stochastically
sampled neighborhood during training. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0</span></code>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GATConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gat_conv.html#GATConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GATConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GATConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gat_conv.html#GATConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GATConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.AGNNConv">
<em class="property">class </em><code class="descname">AGNNConv</code><span class="sig-paren">(</span><em>requires_grad=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/agnn_conv.html#AGNNConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.AGNNConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Graph attentional propagation layer from the
<a class="reference external" href="https://arxiv.org/abs/1803.03735">“Attention-based Graph Neural Network for Semi-Supervised Learning”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}^{\prime} = \mathbf{P} \mathbf{X},\]</div>
<p>where the propagation matrix <span class="math notranslate nohighlight">\(\mathbf{P}\)</span> is computed as</p>
<div class="math notranslate nohighlight">
\[P_{i,j} = \frac{\exp( \beta \cdot \cos(\mathbf{x}_i, \mathbf{x}_j))}
{\sum_{k \in \mathcal{N}(i)\cup \{ i \}} \exp( \beta \cdot
\cos(\mathbf{x}_i, \mathbf{x}_k))}\]</div>
<p>with trainable parameter <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>requires_grad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, <span class="math notranslate nohighlight">\(\beta\)</span>
will not be trainable. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.AGNNConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/agnn_conv.html#AGNNConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.AGNNConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.AGNNConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/agnn_conv.html#AGNNConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.AGNNConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.GINConv">
<em class="property">class </em><code class="descname">GINConv</code><span class="sig-paren">(</span><em>nn</em>, <em>eps=0</em>, <em>train_eps=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gin_conv.html#GINConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GINConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The graph isomorphism operator from the <a class="reference external" href="https://arxiv.org/abs/1810.00826">“How Powerful are
Graph Neural Networks?”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = h_{\mathbf{\Theta}} \left( (1 + \epsilon) \cdot
\mathbf{x}_i + \sum_{j \in \mathcal{N}(i)} \mathbf{x}_j \right),\]</div>
<p>here <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denotes a neural network, <em>.i.e.</em> a MLP.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nn</strong> (<em>nn.Sequential</em>) – Neural network <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>.</li>
<li><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (Initial) <span class="math notranslate nohighlight">\(\epsilon\)</span> value.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0</span></code>)</li>
<li><strong>train_eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, <span class="math notranslate nohighlight">\(\epsilon\)</span>
will be a trainable parameter. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GINConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gin_conv.html#GINConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GINConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GINConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gin_conv.html#GINConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GINConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.ARMAConv">
<em class="property">class </em><code class="descname">ARMAConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>num_stacks=1</em>, <em>num_layers=1</em>, <em>shared_weights=False</em>, <em>act=&lt;function relu&gt;</em>, <em>dropout=0</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/arma_conv.html#ARMAConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.ARMAConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The ARMA graph convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1901.01343">“Graph Neural Networks
with Convolutional ARMA Filters”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}^{\prime} = \frac{1}{K} \sum_{k=1}^K \mathbf{X}_k^{(T)},\]</div>
<p>with <span class="math notranslate nohighlight">\(\mathbf{X}_k^{(T)}\)</span> being recursively defined by</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}_k^{(t+1)} = \sigma \left( \mathbf{\hat{L}}
\mathbf{X}_k^{(t)} \mathbf{W} + \mathbf{X}^{(0)} \mathbf{V} \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\hat{L}} = \mathbf{I} - \mathbf{L} = \mathbf{D}^{-1/2}
\mathbf{A} \mathbf{D}^{-1/2}\)</span> denotes the
modified Laplacian <span class="math notranslate nohighlight">\(\mathbf{L} = \mathbf{I} - \mathbf{D}^{-1/2}
\mathbf{A} \mathbf{D}^{-1/2}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample <span class="math notranslate nohighlight">\(\mathbf{x}^{(t)}\)</span>.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample
<span class="math notranslate nohighlight">\(\mathbf{x}^{(t+1)}\)</span>.</li>
<li><strong>num_stacks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of parallel stacks <span class="math notranslate nohighlight">\(K\)</span>.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>).</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of layers <span class="math notranslate nohighlight">\(T\)</span>.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>act</strong> (<em>callable</em><em>, </em><em>optional</em>) – Activiation function <span class="math notranslate nohighlight">\(\sigma\)</span>.
(default: <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.nn.functional.ReLU()</span></code>)</li>
<li><strong>shared_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> the layers in
each stack will share the same parameters. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>)</li>
<li><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Dropout probability of the skip connection.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0</span></code>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.ARMAConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/arma_conv.html#ARMAConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.ARMAConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.ARMAConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/arma_conv.html#ARMAConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.ARMAConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.SGConv">
<em class="property">class </em><code class="descname">SGConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>K=1</em>, <em>cached=False</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/sg_conv.html#SGConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SGConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The simgple graph convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1902.07153">“Simplifying Graph
Convolutional Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}^{\prime} = {\left(\mathbf{\hat{D}}^{-1/2} \mathbf{\hat{A}}
\mathbf{\hat{D}}^{-1/2} \right)}^K \mathbf{X} \mathbf{\Theta},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\hat{A}} = \mathbf{A} + \mathbf{I}\)</span> denotes the
adjacency matrix with inserted self-loops and
<span class="math notranslate nohighlight">\(\hat{D}_{ii} = \sum_{j=0} \hat{A}_{ij}\)</span> its diagonal degree matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>K</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of hops <span class="math notranslate nohighlight">\(K\)</span>. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>cached</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the layer will cache
the computation of <span class="math notranslate nohighlight">\({\left(\mathbf{\hat{D}}^{-1/2}
\mathbf{\hat{A}} \mathbf{\hat{D}}^{-1/2} \right)}^K \mathbf{X}\)</span>.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.SGConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/sg_conv.html#SGConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SGConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.SGConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/sg_conv.html#SGConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SGConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.APPNP">
<em class="property">class </em><code class="descname">APPNP</code><span class="sig-paren">(</span><em>K</em>, <em>alpha</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/appnp.html#APPNP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.APPNP" title="Permalink to this definition">¶</a></dt>
<dd><p>The approximate personalized propagation of neural predictions layer
from the <a class="reference external" href="https://arxiv.org/abs/1810.05997">“Predict then Propagate: Graph Neural Networks meet Personalized
PageRank”</a> paper</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{X}^{(0)} &amp;= \mathbf{X}\\\mathbf{X}^{(k)} &amp;= (1 - \alpha) \mathbf{\hat{D}}^{-1/2}
\mathbf{\hat{A}} \mathbf{\hat{D}}^{-1/2} \mathbf{X}^{(k-1)} + \alpha
\mathbf{X}^{(0)}\\\mathbf{X}^{\prime} &amp;= \mathbf{X}^{(K)},\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\hat{A}} = \mathbf{A} + \mathbf{I}\)</span> denotes the
adjacency matrix with inserted self-loops and
<span class="math notranslate nohighlight">\(\hat{D}_{ii} = \sum_{j=0} \hat{A}_{ij}\)</span> its diagonal degree matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>K</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of iterations <span class="math notranslate nohighlight">\(K\)</span>.</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Teleport probability <span class="math notranslate nohighlight">\(\alpha\)</span>.</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.APPNP.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/appnp.html#APPNP.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.APPNP.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.RGCNConv">
<em class="property">class </em><code class="descname">RGCNConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>num_relations</em>, <em>num_bases</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/rgcn_conv.html#RGCNConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.RGCNConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The relational graph convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1703.06103">“Modeling
Relational Data with Graph Convolutional Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \mathbf{\Theta}_0 \cdot \mathbf{x}_i +
\sum_{r \in \mathcal{R}} \sum_{j \in \mathcal{N}_r(i)}
\frac{1}{|\mathcal{N}_r(i)|} \mathbf{\Theta}_r \cdot \mathbf{x}_j,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{R}\)</span> denotes the set of relations, <em>i.e.</em> edge types.
Edge type needs to be a one-dimensional <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.long</span></code> tensor which
stores a relation identifier
<span class="math notranslate nohighlight">\(\in \{ 0, \ldots, |\mathcal{R}| - 1\}\)</span> for each edge.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>num_relations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of relations.</li>
<li><strong>num_bases</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of bases used for basis-decomposition.</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.RGCNConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_type</em>, <em>edge_norm=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/rgcn_conv.html#RGCNConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.RGCNConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.RGCNConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/rgcn_conv.html#RGCNConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.RGCNConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.SignedConv">
<em class="property">class </em><code class="descname">SignedConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>first_aggr</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/signed_conv.html#SignedConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SignedConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The signed graph convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1808.06354">“Signed Graph
Convolutional Network”</a> paper</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{x}_v^{(\textrm{pos})} &amp;= \mathbf{\Theta}^{(\textrm{pos})}
\left[ \frac{1}{|\mathcal{N}^{+}(v)|} \sum_{w \in \mathcal{N}^{+}(v)}
\mathbf{x}_w , \mathbf{x}_v \right]\\\mathbf{x}_v^{(\textrm{neg})} &amp;= \mathbf{\Theta}^{(\textrm{neg})}
\left[ \frac{1}{|\mathcal{N}^{-}(v)|} \sum_{w \in \mathcal{N}^{-}(v)}
\mathbf{x}_w , \mathbf{x}_v \right]\end{aligned}\end{align} \]</div>
<p>if <code class="xref py py-obj docutils literal notranslate"><span class="pre">first_aggr</span></code> is set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{x}_v^{(\textrm{pos})} &amp;= \mathbf{\Theta}^{(\textrm{pos})}
\left[ \frac{1}{|\mathcal{N}^{+}(v)|} \sum_{w \in \mathcal{N}^{+}(v)}
\mathbf{x}_w^{(\textrm{pos})}, \frac{1}{|\mathcal{N}^{-}(v)|}
\sum_{w \in \mathcal{N}^{-}(v)} \mathbf{x}_w^{(\textrm{neg})} ,
\mathbf{x}_v^{(\textrm{pos})} \right]\\\mathbf{x}_v^{(\textrm{neg})} &amp;= \mathbf{\Theta}^{(\textrm{pos})}
\left[ \frac{1}{|\mathcal{N}^{+}(v)|} \sum_{w \in \mathcal{N}^{+}(v)}
\mathbf{x}_w^{(\textrm{neg})}, \frac{1}{|\mathcal{N}^{-}(v)|}
\sum_{w \in \mathcal{N}^{-}(v)} \mathbf{x}_w^{(\textrm{pos})} ,
\mathbf{x}_v^{(\textrm{neg})} \right]\end{aligned}\end{align} \]</div>
<p>otherwise.
In case <code class="xref py py-obj docutils literal notranslate"><span class="pre">first_aggr</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer expects <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> to be
a tensor where <code class="xref py py-obj docutils literal notranslate"><span class="pre">x[:,</span> <span class="pre">:in_channels]</span></code> denotes the positive node features
<span class="math notranslate nohighlight">\(\mathbf{X}^{(\textrm{pos})}\)</span> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x[:,</span> <span class="pre">in_channels:]</span></code> denotes
the negative node features <span class="math notranslate nohighlight">\(\mathbf{X}^{(\textrm{neg})}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>first_aggr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Denotes which aggregation formula to use.</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.SignedConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>pos_edge_index</em>, <em>neg_edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/signed_conv.html#SignedConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SignedConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.SignedConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/signed_conv.html#SignedConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SignedConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.DNAConv">
<em class="property">class </em><code class="descname">DNAConv</code><span class="sig-paren">(</span><em>channels</em>, <em>heads=1</em>, <em>groups=1</em>, <em>dropout=0</em>, <em>cached=False</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/dna_conv.html#DNAConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.DNAConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The dynamic neighborhood aggregation operator from the <a class="reference external" href="https://arxiv.org/abs/1904.04849">“Just Jump:
Towards Dynamic Neighborhood Aggregation in Graph Neural Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}_v^{(t)} = h_{\mathbf{\Theta}}^{(t)} \left( \mathbf{x}_{v
\leftarrow v}^{(t)}, \left\{ \mathbf{x}_{v \leftarrow w}^{(t)} : w \in
\mathcal{N}(v) \right\} \right)\]</div>
<p>based on (multi-head) dot-product attention</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}_{v \leftarrow w}^{(t)} = \textrm{Attention} \left(
\mathbf{x}^{(t-1)}_v \, \mathbf{\Theta}_Q^{(t)}, [\mathbf{x}_w^{(1)},
\ldots, \mathbf{x}_w^{(t-1)}] \, \mathbf{Q}_K^{(t)}, \,
[\mathbf{x}_w^{(1)}, \ldots, \mathbf{x}_w^{(t-1)}] \,
\mathbf{Q}_V^{(t)} \right)\]</div>
<p>with <span class="math notranslate nohighlight">\(\mathbf{\Theta}_Q^{(t)}, \mathbf{\Theta}_K^{(t)},
\mathbf{\Theta}_V^{(t)}\)</span> denoting (grouped) projection matrices for query,
key and value information, respectively.
<span class="math notranslate nohighlight">\(h^{(t)}_{\mathbf{\Theta}}\)</span> is implemented as a non-trainable
version of <a class="reference internal" href="#torch_geometric.nn.conv.GCNConv" title="torch_geometric.nn.conv.GCNConv"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.nn.conv.GCNConv</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In contrast to other layers, this operator expects node features as
shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">[num_nodes,</span> <span class="pre">num_layers,</span> <span class="pre">channels]</span></code>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input/output sample.</li>
<li><strong>heads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of multi-head-attentions.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of groups to use for all linear
projections. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Dropout probability of attention
coefficients. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0</span></code>)</li>
<li><strong>cached</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the layer will cache
the computation of <span class="math notranslate nohighlight">\({\left(\mathbf{\hat{D}}^{-1/2}
\mathbf{\hat{A}} \mathbf{\hat{D}}^{-1/2} \right)}\)</span>.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.DNAConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/dna_conv.html#DNAConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.DNAConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.DNAConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/dna_conv.html#DNAConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.DNAConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.PointConv">
<em class="property">class </em><code class="descname">PointConv</code><span class="sig-paren">(</span><em>local_nn=None</em>, <em>global_nn=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/point_conv.html#PointConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.PointConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The PointNet set layer from the <a class="reference external" href="https://arxiv.org/abs/1612.00593">“PointNet: Deep Learning on Point Sets
for 3D Classification and Segmentation”</a> and <a class="reference external" href="https://arxiv.org/abs/1706.02413">“PointNet++: Deep Hierarchical
Feature Learning on Point Sets in a Metric Space”</a> papers</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \gamma_{\mathbf{\Theta}} \left( \max_{j \in
\mathcal{N}(i) \cup \{ i \}} h_{\mathbf{\Theta}} ( \mathbf{x}_j,
\mathbf{p}_j - \mathbf{p}_i) \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span> and
<span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denote neural
networks, <em>.i.e.</em> MLPs, and <span class="math notranslate nohighlight">\(\mathbf{P} \in \mathbb{R}^{N \times D}\)</span>
defines the position of each point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local_nn</strong> (<em>nn.Sequential</em><em>, </em><em>optional</em>) – Neural network
<span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>global_nn</strong> (<em>nn.Sequential</em><em>, </em><em>optional</em>) – Neural network
<span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.PointConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>pos</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/point_conv.html#PointConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.PointConv.forward" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>Tensor</em>) – The node feature matrix. Allowed to be <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</li>
<li><strong>pos</strong> (<em>Tensor</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – The node position matrix. Either given as
tensor for use in general message passing or as tuple for use
in message passing in bipartite graphs.</li>
<li><strong>edge_index</strong> (<em>LongTensor</em>) – The edge indices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.PointConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/point_conv.html#PointConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.PointConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.GMMConv">
<em class="property">class </em><code class="descname">GMMConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>dim</em>, <em>kernel_size</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gmm_conv.html#GMMConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GMMConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The gaussian mixture model convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1611.08402">“Geometric
Deep Learning on Graphs and Manifolds using Mixture Model CNNs”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \mathbf{\Theta} \cdot
\sum_{j \in \mathcal{N}(i) \cup \{ i \}} \sum_{k=1}^K
\mathbf{w}_k(\mathbf{e}_{i,j}) \odot \mathbf{x}_j,\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\mathbf{w}_k(\mathbf{e}) = \exp \left( -\frac{1}{2} {\left(
\mathbf{e} - \mathbf{\mu}_k \right)}^{\top} \Sigma_k^{-1}
\left( \mathbf{e} - \mathbf{\mu}_k \right) \right)\]</div>
<p>denotes a weighting function based on trainable mean vector
<span class="math notranslate nohighlight">\(\mathbf{\mu}_k\)</span> and diagonal covariance matrix
<span class="math notranslate nohighlight">\(\mathbf{\Sigma}_k\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Pseudo-coordinate dimensionality.</li>
<li><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of kernels <span class="math notranslate nohighlight">\(K\)</span>.</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GMMConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>pseudo</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gmm_conv.html#GMMConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GMMConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GMMConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gmm_conv.html#GMMConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GMMConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.SplineConv">
<em class="property">class </em><code class="descname">SplineConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>dim</em>, <em>kernel_size</em>, <em>is_open_spline=True</em>, <em>degree=1</em>, <em>norm=True</em>, <em>root_weight=True</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/spline_conv.html#SplineConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SplineConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The spline-based convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1711.08920">“SplineCNN: Fast
Geometric Deep Learning with Continuous B-Spline Kernels”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \frac{1}{|\mathcal{N}(i)|} \sum_{j \in
\mathcal{N}(i)} \mathbf{x}_j \cdot
h_{\mathbf{\Theta}}(\mathbf{e}_{i,j}),\]</div>
<p>where <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denotes a kernel function defined
over the weighted B-Spline tensor product basis.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Pseudo-coordinates must lay in the fixed interval <span class="math notranslate nohighlight">\([0, 1]\)</span> for
this method to work as intended.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Pseudo-coordinate dimensionality.</li>
<li><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>]</em>) – Size of the convolving kernel.</li>
<li><strong>is_open_spline</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em> or </em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>]</em><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the
operator will use a closed B-spline basis in this dimension.
(default <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
<li><strong>degree</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – B-spline basis degrees. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, output node features
will not be degree-normalized. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
<li><strong>root_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will
not add transformed root node features to the output.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.SplineConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>pseudo</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/spline_conv.html#SplineConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SplineConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.SplineConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/spline_conv.html#SplineConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SplineConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.NNConv">
<em class="property">class </em><code class="descname">NNConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>nn</em>, <em>aggr='add'</em>, <em>root_weight=True</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/nn_conv.html#NNConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.NNConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuous kernel-based convolutional operator adapted from the
<a class="reference external" href="https://arxiv.org/abs/1704.01212">“Neural Message Passing for Quantum Chemistry”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \mathbf{\Theta} \mathbf{x}_i +
\sum_{j \in \mathcal{N}(i)} \mathbf{x}_j \cdot
h_{\mathbf{\Theta}}(\mathbf{e}_{i,j}),\]</div>
<p>where <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denotes a neural network, <em>.i.e.</em>
a MLP.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>nn</strong> (<em>nn.Sequential</em>) – Neural network <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>.</li>
<li><strong>aggr</strong> (<em>string</em>) – The aggregation operator to use (<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>). (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>)</li>
<li><strong>root_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will
not add the transformed root node features to the output.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.NNConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_attr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/nn_conv.html#NNConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.NNConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.NNConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/nn_conv.html#NNConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.NNConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.EdgeConv">
<em class="property">class </em><code class="descname">EdgeConv</code><span class="sig-paren">(</span><em>nn</em>, <em>aggr='max'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/edge_conv.html#EdgeConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.EdgeConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The edge convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1801.07829">“Dynamic Graph CNN for
Learning on Point Clouds”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \sum_{j \in \mathcal{N}(i)}
h_{\mathbf{\Theta}}(\mathbf{x}_i \, \Vert \,
\mathbf{x}_j - \mathbf{x}_i),\]</div>
<p>where <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denotes a neural network, <em>.i.e.</em> a MLP.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nn</strong> (<em>nn.Sequential</em>) – Neural network <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>.</li>
<li><strong>aggr</strong> (<em>string</em>) – The aggregation operator to use (<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>). (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.EdgeConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/edge_conv.html#EdgeConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.EdgeConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.EdgeConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/edge_conv.html#EdgeConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.EdgeConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.XConv">
<em class="property">class </em><code class="descname">XConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>dim</em>, <em>kernel_size</em>, <em>hidden_channels=None</em>, <em>dilation=1</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/x_conv.html#XConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.XConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The convolutional operator on <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>-transformed points
from the <a class="reference external" href="https://arxiv.org/abs/1801.07791">“PointCNN: Convolution On X-Transformed Points”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \mathrm{Conv}\left(\mathbf{K},
\gamma_{\mathbf{\Theta}}(\mathbf{P}_i - \mathbf{p}_i) \times
\left( h_\mathbf{\Theta}(\mathbf{P}_i - \mathbf{p}_i) \, \Vert \,
\mathbf{x}_i \right) \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{P}_i\)</span> denote the trainable
filter and neighboring point positions of <span class="math notranslate nohighlight">\(\mathbf{x}_i\)</span>,
respectively.
<span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span> and <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> describe
neural networks, <em>i.e.</em> MLPs, where <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>
individually lifts each point into a higher-dimensional space, and
<span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span> computes the <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>-
transformation matrix based on <em>all</em> points in a neighborhood.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Point cloud dimensionality.</li>
<li><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of the convolving kernel, <em>i.e.</em> number of
neighbors including self-loops.</li>
<li><strong>hidden_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Output size of
<span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>, <em>i.e.</em> dimensionality of lifted
points. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, will be automatically set to
<code class="xref py py-obj docutils literal notranslate"><span class="pre">in_channels</span> <span class="pre">/</span> <span class="pre">4</span></code>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The factor by which the neighborhood is
extended, from which <code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel_size</span></code> neighbors are then
uniformly sampled. Can be interpreted as the dilation rate of
classical convolutional operators. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.XConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>pos</em>, <em>batch=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/x_conv.html#XConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.XConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.XConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/x_conv.html#XConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.XConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.PPFConv">
<em class="property">class </em><code class="descname">PPFConv</code><span class="sig-paren">(</span><em>local_nn=None</em>, <em>global_nn=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/ppf_conv.html#PPFConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.PPFConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The PPFNet operator from the <a class="reference external" href="https://arxiv.org/abs/1802.02669">“PPFNet: Global Context Aware Local
Features for Robust 3D Point Matching”</a>
paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \gamma_{\mathbf{\Theta}} \left( \max_{j \in
\mathcal{N}(i) \cup \{ i \}} h_{\mathbf{\Theta}} ( \mathbf{x}_j, \|
\mathbf{d_{j,i}} \|, \angle(\mathbf{n}_i, \mathbf{d_{j,i}}),
\angle(\mathbf{n}_j, \mathbf{d_{j,i}}), \angle(\mathbf{n}_i,
\mathbf{n}_j) \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span> and <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>
denote neural networks, <em>.i.e.</em> MLPs, which takes in node features and
<a class="reference internal" href="transforms.html#torch_geometric.transforms.PointPairFeatures" title="torch_geometric.transforms.PointPairFeatures"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.transforms.PointPairFeatures</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local_nn</strong> (<em>nn.Sequential</em><em>, </em><em>optional</em>) – Neural network
<span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>global_nn</strong> (<em>nn.Sequential</em><em>, </em><em>optional</em>) – Neural network
<span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.PPFConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>pos</em>, <em>norm</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/ppf_conv.html#PPFConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.PPFConv.forward" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>Tensor</em>) – The node feature matrix. Allowed to be <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</li>
<li><strong>pos</strong> (<em>Tensor</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – The node position matrix. Either given as
tensor for use in general message passing or as tuple for use
in message passing in bipartite graphs.</li>
<li><strong>norm</strong> (<em>Tensor</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – The normal vectors of each node. Either
given as tensor for use in general message passing or as tuple
for use in message passing in bipartite graphs.</li>
<li><strong>edge_index</strong> (<em>LongTensor</em>) – The edge indices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.PPFConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/ppf_conv.html#PPFConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.PPFConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<span class="target" id="module-torch_geometric.nn.meta"></span><dl class="class">
<dt id="torch_geometric.nn.meta.MetaLayer">
<em class="property">class </em><code class="descname">MetaLayer</code><span class="sig-paren">(</span><em>edge_model=None</em>, <em>node_model=None</em>, <em>global_model=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/meta.html#MetaLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.meta.MetaLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>A meta layer for building any kind of graph network, inspired by the
<a class="reference external" href="https://arxiv.org/abs/1806.01261">“Relational Inductive Biases, Deep Learning, and Graph Networks”</a> paper.</p>
<p>A graph network takes a graph as input and returns an updated graph as
output (with same connectivity).
The input graph has node features <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code>, edge features <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_attr</span></code>
as well as global-level features <code class="xref py py-obj docutils literal notranslate"><span class="pre">u</span></code>.
The output graph has the same structure, but updated features.</p>
<p>Edge features, node features as well as global features are updated by
calling the functions <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_model</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">node_model</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">global_model</span></code>, respectively.</p>
<p>To allow for batch-wise graph processing, all callable functions take an
additional argument <code class="xref py py-obj docutils literal notranslate"><span class="pre">batch</span></code>, which determines the assignment of
edges or nodes to their specific graphs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>edge_model</strong> (<em>func</em><em>, </em><em>optional</em>) – A callable which updates a graph’s edge
features based on its source and target node features, its current
edge features and its global features. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>node_model</strong> (<em>func</em><em>, </em><em>optional</em>) – A callable which updates a graph’s node
features based on its current node features, its graph
connectivity, its edge features and its global features.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>global_model</strong> (<em>func</em><em>, </em><em>optional</em>) – A callable which updates a graph’s
global features based on its node features, its graph connectivity,
its edge features and its current global features.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">Sequential</span> <span class="k">as</span> <span class="n">Seq</span><span class="p">,</span> <span class="n">Linear</span> <span class="k">as</span> <span class="n">Lin</span><span class="p">,</span> <span class="n">ReLU</span>
<span class="kn">from</span> <span class="nn">torch_scatter</span> <span class="kn">import</span> <span class="n">scatter_mean</span>
<span class="kn">from</span> <span class="nn">torch_geometric.nn</span> <span class="kn">import</span> <span class="n">MetaLayer</span>

<span class="k">class</span> <span class="nc">MyLayer</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyLayer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edge_mlp</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span> <span class="n">ReLU</span><span class="p">(),</span> <span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_mlp_1</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span> <span class="n">ReLU</span><span class="p">(),</span> <span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_mlp_2</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span> <span class="n">ReLU</span><span class="p">(),</span> <span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_mlp</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span> <span class="n">ReLU</span><span class="p">(),</span> <span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">edge_model</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
            <span class="c1"># source, target: [E, F_x], where E is the number of edges.</span>
            <span class="c1"># edge_attr: [E, F_e]</span>
            <span class="c1"># u: [B, F_u], where B is the number of graphs.</span>
            <span class="c1"># batch: [E] with max entry B - 1.</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="n">batch</span><span class="p">]],</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_mlp</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">node_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
            <span class="c1"># x: [N, F_x], where N is the number of nodes.</span>
            <span class="c1"># edge_index: [2, E] with max entry N - 1.</span>
            <span class="c1"># edge_attr: [E, F_e]</span>
            <span class="c1"># u: [B, F_u]</span>
            <span class="c1"># batch: [N] with max entry B - 1.</span>
            <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">edge_index</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">edge_attr</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_mlp</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">scatter_mean</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim_size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">out</span><span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="n">batch</span><span class="p">]],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_mlp_2</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">global_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
            <span class="c1"># x: [N, F_x], where N is the number of nodes.</span>
            <span class="c1"># edge_index: [2, E] with max entry N - 1.</span>
            <span class="c1"># edge_attr: [E, F_e]</span>
            <span class="c1"># u: [B, F_u]</span>
            <span class="c1"># batch: [N] with max entry B - 1.</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">scatter_mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_mlp</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">MetaLayer</span><span class="p">(</span><span class="n">edge_model</span><span class="p">,</span> <span class="n">node_model</span><span class="p">,</span> <span class="n">global_model</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="torch_geometric.nn.meta.MetaLayer.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_attr=None</em>, <em>u=None</em>, <em>batch=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/meta.html#MetaLayer.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.meta.MetaLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.meta.MetaLayer.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/meta.html#MetaLayer.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.meta.MetaLayer.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<span class="target" id="module-torch_geometric.nn.dense.dense_sage_conv"></span><dl class="class">
<dt id="torch_geometric.nn.dense.dense_sage_conv.DenseSAGEConv">
<em class="property">class </em><code class="descname">DenseSAGEConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>normalize=True</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/dense/dense_sage_conv.html#DenseSAGEConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.dense.dense_sage_conv.DenseSAGEConv" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#torch_geometric.nn.conv.SAGEConv" title="torch_geometric.nn.conv.SAGEConv"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.nn.conv.SAGEConv</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.dense.dense_sage_conv.DenseSAGEConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>adj</em>, <em>mask=None</em>, <em>add_loop=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/dense/dense_sage_conv.html#DenseSAGEConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.dense.dense_sage_conv.DenseSAGEConv.forward" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature tensor <span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{B
\times N \times F}\)</span>, with batch-size <span class="math notranslate nohighlight">\(B\)</span>, (maximum)
number of nodes <span class="math notranslate nohighlight">\(N\)</span> for each graph, and feature
dimension <span class="math notranslate nohighlight">\(F\)</span>.</li>
<li><strong>adj</strong> (<em>Tensor</em>) – Adjacency tensor <span class="math notranslate nohighlight">\(\mathbf{A} \in \mathbb{R}^{B
\times N \times N}\)</span>.</li>
<li><strong>mask</strong> (<em>ByteTensor</em><em>, </em><em>optional</em>) – Mask matrix
<span class="math notranslate nohighlight">\(\mathbf{M} \in {\{ 0, 1 \}}^{B \times N}\)</span> indicating
the valid nodes for each graph. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>add_loop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will
not automatically add self-loops to the adjacency matrices.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.dense.dense_sage_conv.DenseSAGEConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/dense/dense_sage_conv.html#DenseSAGEConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.dense.dense_sage_conv.DenseSAGEConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-torch_geometric.nn.glob">
<span id="global-pooling-layers"></span><h2><a class="toc-backref" href="#id9">Global Pooling Layers</a><a class="headerlink" href="#module-torch_geometric.nn.glob" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="torch_geometric.nn.glob.global_add_pool">
<code class="descname">global_add_pool</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/glob.html#global_add_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.global_add_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns batch-wise graph-level-outputs by adding node features
across the node node dimension, so that for a single graph
<span class="math notranslate nohighlight">\(\mathcal{G}_i\)</span> its output is computed by</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}_i = \sum_{n=1}^{N_i} \mathbf{x}_n\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific example.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Batch-size <span class="math notranslate nohighlight">\(B\)</span>.
Automatically calculated if not given. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.glob.global_mean_pool">
<code class="descname">global_mean_pool</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/glob.html#global_mean_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.global_mean_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns batch-wise graph-level-outputs by averaging node features
across the node node dimension, so that for a single graph
<span class="math notranslate nohighlight">\(\mathcal{G}_i\)</span> its output is computed by</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}_i = \frac{1}{N_i} \sum_{n=1}^{N_i} \mathbf{x}_n\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific example.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Batch-size <span class="math notranslate nohighlight">\(B\)</span>.
Automatically calculated if not given. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.glob.global_max_pool">
<code class="descname">global_max_pool</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/glob.html#global_max_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.global_max_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns batch-wise graph-level-outputs by taking the channel-wise
maximum across the node dimension, so that for a single graph
<span class="math notranslate nohighlight">\(\mathcal{G}_i\)</span> its output is computed by</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}_i = \mathrm{max}_{n=1}^{N_i} \, \mathbf{x}_n\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific example.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Batch-size <span class="math notranslate nohighlight">\(B\)</span>.
Automatically calculated if not given. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.glob.global_sort_pool">
<code class="descname">global_sort_pool</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em>, <em>k</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/sort.html#global_sort_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.global_sort_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>The global pooling operator from the <a class="reference external" href="https://www.cse.wustl.edu/~muhan/papers/AAAI_2018_DGCNN.pdf">“An End-to-End Deep Learning
Architecture for Graph Classification”</a> paper,
where node features are first sorted individually and then  sorted in
descending order based on their last features. The first <span class="math notranslate nohighlight">\(k\)</span> nodes
form the output of the layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{N \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific example.</li>
<li><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The number of nodes to hold for each graph.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.glob.GlobalAttention">
<em class="property">class </em><code class="descname">GlobalAttention</code><span class="sig-paren">(</span><em>gate_nn</em>, <em>nn=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/attention.html#GlobalAttention"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.GlobalAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>Global soft attention layer from the <a class="reference external" href="https://arxiv.org/abs/1511.05493">“Gated Graph Sequence Neural
Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}_i = \sum_{n=1}^{N_i} \mathrm{softmax} \left(
h_{\mathrm{gate}} ( \mathbf{x}_n ) \right) \odot
h_{\mathbf{\Theta}} ( \mathbf{x}_n ),\]</div>
<p>where <span class="math notranslate nohighlight">\(h_{\mathrm{gate}} \colon \mathbb{R}^F \to
\mathbb{R}\)</span> and <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denote neural networks, <em>i.e.</em>
MLPS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>gate_nn</strong> (<em>nn.Sequential</em>) – Neural network
<span class="math notranslate nohighlight">\(h_{\mathrm{gate}} \colon \mathbb{R}^F \to \mathbb{R}\)</span>.</li>
<li><strong>nn</strong> (<em>nn.Sequential</em><em>, </em><em>optional</em>) – Neural network
<span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.glob.GlobalAttention.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/attention.html#GlobalAttention.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.GlobalAttention.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.glob.GlobalAttention.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/attention.html#GlobalAttention.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.GlobalAttention.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.glob.Set2Set">
<em class="property">class </em><code class="descname">Set2Set</code><span class="sig-paren">(</span><em>in_channels</em>, <em>processing_steps</em>, <em>num_layers=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/set2set.html#Set2Set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.Set2Set" title="Permalink to this definition">¶</a></dt>
<dd><p>The global pooling operator based on iterative content-based attention
from the <a class="reference external" href="https://arxiv.org/abs/1511.06391">“Order Matters: Sequence to sequence for sets”</a> paper</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{q}_t &amp;= \mathrm{LSTM}(\mathbf{q}^{*}_{t-1})\\\alpha_{i,t} &amp;= \mathrm{softmax}(\mathbf{x}_i \cdot \mathbf{q}_t)\\\mathbf{r}_t &amp;= \sum_{i=1}^N \alpha_{i,t} \mathbf{x}_i\\\mathbf{q}^{*}_t &amp;= \mathbf{q}_t \, \Vert \, \mathbf{r}_t,\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{q}^{*}_T\)</span> defines the output of the layer with twice
the dimensionality as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>processing_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of iterations <span class="math notranslate nohighlight">\(T\)</span>.</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of recurrent layers, <em>.e.g</em>, setting
<code class="xref py py-obj docutils literal notranslate"><span class="pre">num_layers=2</span></code> would mean stacking two LSTMs together to form
a stacked LSTM, with the second LSTM taking in outputs of the first
LSTM and computing the final results. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.glob.Set2Set.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/set2set.html#Set2Set.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.Set2Set.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.glob.Set2Set.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/set2set.html#Set2Set.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.Set2Set.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-torch_geometric.nn.pool">
<span id="pooling-layers"></span><h2><a class="toc-backref" href="#id10">Pooling Layers</a><a class="headerlink" href="#module-torch_geometric.nn.pool" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch_geometric.nn.pool.TopKPooling">
<em class="property">class </em><code class="descname">TopKPooling</code><span class="sig-paren">(</span><em>in_channels</em>, <em>ratio=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/topk_pool.html#TopKPooling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.TopKPooling" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="math notranslate nohighlight">\(\mathrm{top}_k\)</span> pooling operator from the <a class="reference external" href="https://openreview.net/forum?id=HJePRoAct7">“Graph U-Net”</a> and <a class="reference external" href="https://arxiv.org/abs/1811.01287">“Towards Sparse
Hierarchical Graph Classifiers”</a> papers</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{y} &amp;= \frac{\mathbf{X}\mathbf{p}}{\| \mathbf{p} \|}\\\mathbf{i} &amp;= \mathrm{top}_k(\mathbf{y})\\\mathbf{X}^{\prime} &amp;= (\mathbf{X} \odot
\mathrm{tanh}(\mathbf{y}))_{\mathbf{i}}\\\mathbf{A}^{\prime} &amp;= \mathbf{A}_{\mathbf{i},\mathbf{i}},\end{aligned}\end{align} \]</div>
<p>where nodes are dropped based on a learnable projection score
<span class="math notranslate nohighlight">\(\mathbf{p}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Graph pooling ratio, which is used to compute
<span class="math notranslate nohighlight">\(k = \lceil \mathrm{ratio} \cdot N \rceil\)</span>.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0.5</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.pool.TopKPooling.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_attr=None</em>, <em>batch=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/topk_pool.html#TopKPooling.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.TopKPooling.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.pool.TopKPooling.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/topk_pool.html#TopKPooling.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.TopKPooling.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.max_pool">
<code class="descname">max_pool</code><span class="sig-paren">(</span><em>cluster</em>, <em>data</em>, <em>transform=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/max_pool.html#max_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.max_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Pools and coarsens a graph given by the
<a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code></a> object according to the clustering
defined in <code class="xref py py-attr docutils literal notranslate"><span class="pre">cluster</span></code>.
All nodes within the same cluster will be represented as one node.
Final node features are defined by the <em>maximum</em> features of all nodes
within the same cluster, node positions are averaged and edge indices are
defined to be the union of the edge indices of all nodes within the same
cluster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> (<em>LongTensor</em>) – Cluster vector <span class="math notranslate nohighlight">\(\mathbf{c} \in \{ 0,
\ldots, N - 1 \}^N\)</span>, which assigns each node to a specific cluster.</li>
<li><strong>data</strong> (<a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><em>Data</em></a>) – Graph data object.</li>
<li><strong>transform</strong> (<em>callable</em><em>, </em><em>optional</em>) – A function/transform that takes in the
coarsened and pooled <a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code></a> object and
returns a transformed version. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.avg_pool">
<code class="descname">avg_pool</code><span class="sig-paren">(</span><em>cluster</em>, <em>data</em>, <em>transform=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/avg_pool.html#avg_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.avg_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Pools and coarsens a graph given by the
<a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code></a> object according to the clustering
defined in <code class="xref py py-attr docutils literal notranslate"><span class="pre">cluster</span></code>.
Final node features are defined by the <em>average</em> features of all nodes
within the same cluster.
See <a class="reference internal" href="#torch_geometric.nn.pool.max_pool" title="torch_geometric.nn.pool.max_pool"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch_geometric.nn.pool.max_pool()</span></code></a> for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> (<em>LongTensor</em>) – Cluster vector <span class="math notranslate nohighlight">\(\mathbf{c} \in \{ 0,
\ldots, N - 1 \}^N\)</span>, which assigns each node to a specific cluster.</li>
<li><strong>data</strong> (<a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><em>Data</em></a>) – Graph data object.</li>
<li><strong>transform</strong> (<em>callable</em><em>, </em><em>optional</em>) – A function/transform that takes in the
coarsened and pooled <a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code></a> object and
returns a transformed version. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.max_pool_x">
<code class="descname">max_pool_x</code><span class="sig-paren">(</span><em>cluster</em>, <em>x</em>, <em>batch</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/max_pool.html#max_pool_x"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.max_pool_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Max-Pools node features according to the clustering defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">cluster</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> (<em>LongTensor</em>) – Cluster vector <span class="math notranslate nohighlight">\(\mathbf{c} \in \{ 0,
\ldots, N - 1 \}^N\)</span>, which assigns each node to a specific cluster.</li>
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific example.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The maximum number of clusters in a single
example. This property is useful to obtain a batch-wise dense
representation, <em>e.g.</em> for applying FC layers, but should only be
used if the size of the maximum number of clusters per example is
known in advance. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">LongTensor</span></code>) if <code class="xref py py-attr docutils literal notranslate"><span class="pre">size</span></code> is
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, else <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.avg_pool_x">
<code class="descname">avg_pool_x</code><span class="sig-paren">(</span><em>cluster</em>, <em>x</em>, <em>batch</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/avg_pool.html#avg_pool_x"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.avg_pool_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Average pools node features according to the clustering defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">cluster</span></code>.
See <a class="reference internal" href="#torch_geometric.nn.pool.max_pool_x" title="torch_geometric.nn.pool.max_pool_x"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch_geometric.nn.pool.max_pool_x()</span></code></a> for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> (<em>LongTensor</em>) – Cluster vector <span class="math notranslate nohighlight">\(\mathbf{c} \in \{ 0,
\ldots, N - 1 \}^N\)</span>, which assigns each node to a specific cluster.</li>
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific example.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The maximum number of clusters in a single
example. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">LongTensor</span></code>) if <code class="xref py py-attr docutils literal notranslate"><span class="pre">size</span></code> is
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, else <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.graclus">
<code class="descname">graclus</code><span class="sig-paren">(</span><em>edge_index</em>, <em>weight=None</em>, <em>num_nodes=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/graclus.html#graclus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.graclus" title="Permalink to this definition">¶</a></dt>
<dd><p>A greedy clustering algorithm from the <a class="reference external" href="http://www.cs.utexas.edu/users/inderjit/public_papers/multilevel_pami.pdf">“Weighted Graph Cuts without
Eigenvectors: A Multilevel Approach”</a> paper of picking an unmarked
vertex and matching it with one of its unmarked neighbors (that maximizes
its edge weight).
The GPU algoithm is adapted from the <a class="reference external" href="http://www.staff.science.uu.nl/~bisse101/Articles/match12.pdf">“A GPU Algorithm for Greedy Graph
Matching”</a>
paper.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>edge_index</strong> (<em>LongTensor</em>) – The edge indices.</li>
<li><strong>weight</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – One-dimensional edge weights.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>num_nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The number of nodes, <em>i.e.</em>
<code class="xref py py-obj docutils literal notranslate"><span class="pre">max_val</span> <span class="pre">+</span> <span class="pre">1</span></code> of <code class="xref py py-attr docutils literal notranslate"><span class="pre">edge_index</span></code>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">LongTensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.voxel_grid">
<code class="descname">voxel_grid</code><span class="sig-paren">(</span><em>pos</em>, <em>batch</em>, <em>size</em>, <em>start=None</em>, <em>end=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/voxel_grid.html#voxel_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.voxel_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Voxel grid pooling from the, <em>e.g.</em>, <a class="reference external" href="https://arxiv.org/abs/1704.02901">Dynamic Edge-Conditioned Filters
in Convolutional Networks on Graphs</a>
paper, which overlays a regular grid of user-defined size over a point
cloud and clusters all points within the same voxel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos</strong> (<em>Tensor</em>) – Node position matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times D}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific example.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>]</em>) – Size of a voxel (in each dimension).</li>
<li><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – Start coordinates of the grid (in
each dimension). If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, will be set to the minimum
coordinates found in <code class="xref py py-attr docutils literal notranslate"><span class="pre">pos</span></code>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – End coordinates of the grid (in
each dimension). If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, will be set to the maximum
coordinates found in <code class="xref py py-attr docutils literal notranslate"><span class="pre">pos</span></code>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">LongTensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.fps">
<code class="descname">fps</code><span class="sig-paren">(</span><em>x</em>, <em>batch=None</em>, <em>ratio=0.5</em>, <em>random_start=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_cluster/fps.html#fps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.fps" title="Permalink to this definition">¶</a></dt>
<dd><p>“A sampling algorithm from the <a class="reference external" href="https://arxiv.org/abs/1706.02413">“PointNet++: Deep Hierarchical Feature
Learning on Point Sets in a Metric Space”</a> paper, which iteratively samples the
most distant point with regard to the rest points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{N \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots, B-1\}}^N\)</span>, which assigns each
node to a specific example. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Sampling ratio. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0.5</span></code>)</li>
<li><strong>random_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, use the first
node in <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> as starting node. (default: obj:<cite>True</cite>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">LongTensor</span></code></p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">fps</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.knn">
<code class="descname">knn</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>k</em>, <em>batch_x=None</em>, <em>batch_y=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_cluster/knn.html#knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.knn" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds for each element in <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code> the <code class="xref py py-obj docutils literal notranslate"><span class="pre">k</span></code> nearest points in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{N \times F}\)</span>.</li>
<li><strong>y</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{M \times F}\)</span>.</li>
<li><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The number of neighbors.</li>
<li><strong>batch_x</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots, B-1\}}^N\)</span>, which assigns each
node to a specific example. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>batch_y</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots, B-1\}}^M\)</span>, which assigns each
node to a specific example. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">LongTensor</span></code></p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assign_index</span> <span class="o">=</span> <span class="n">knn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.knn_graph">
<code class="descname">knn_graph</code><span class="sig-paren">(</span><em>x</em>, <em>k</em>, <em>batch=None</em>, <em>loop=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_cluster/knn.html#knn_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.knn_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes graph edges to the nearest <code class="xref py py-obj docutils literal notranslate"><span class="pre">k</span></code> points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{N \times F}\)</span>.</li>
<li><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The number of neighbors.</li>
<li><strong>batch</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots, B-1\}}^N\)</span>, which assigns each
node to a specific example. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>loop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the graph will contain
self-loops. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">LongTensor</span></code></p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edge_index</span> <span class="o">=</span> <span class="n">knn_graph</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.radius">
<code class="descname">radius</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>r</em>, <em>batch_x=None</em>, <em>batch_y=None</em>, <em>max_num_neighbors=32</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_cluster/radius.html#radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds for each element in <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code> all points in <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> within
distance <code class="xref py py-obj docutils literal notranslate"><span class="pre">r</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{N \times F}\)</span>.</li>
<li><strong>y</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{Y} \in \mathbb{R}^{M \times F}\)</span>.</li>
<li><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The radius.</li>
<li><strong>batch_x</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots, B-1\}}^N\)</span>, which assigns each
node to a specific example. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>batch_y</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots, B-1\}}^M\)</span>, which assigns each
node to a specific example. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>max_num_neighbors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The maximum number of neighbors to
return for each element in <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code>. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">32</span></code>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">LongTensor</span></code></p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assign_index</span> <span class="o">=</span> <span class="n">radius</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.radius_graph">
<code class="descname">radius_graph</code><span class="sig-paren">(</span><em>x</em>, <em>r</em>, <em>batch=None</em>, <em>loop=False</em>, <em>max_num_neighbors=32</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_cluster/radius.html#radius_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.radius_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes graph edges to all points within a given distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{N \times F}\)</span>.</li>
<li><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The radius.</li>
<li><strong>batch</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots, B-1\}}^N\)</span>, which assigns each
node to a specific example. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>loop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the graph will contain
self-loops. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>)</li>
<li><strong>max_num_neighbors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The maximum number of neighbors to
return for each element in <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code>. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">32</span></code>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">LongTensor</span></code></p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edge_index</span> <span class="o">=</span> <span class="n">radius_graph</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.nearest">
<code class="descname">nearest</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>batch_x=None</em>, <em>batch_y=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_cluster/nearest.html#nearest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.nearest" title="Permalink to this definition">¶</a></dt>
<dd><p>Clusters points in <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> together which are nearest to a given query
point in <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{N \times F}\)</span>.</li>
<li><strong>y</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{Y} \in \mathbb{R}^{M \times F}\)</span>.</li>
<li><strong>batch_x</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots, B-1\}}^N\)</span>, which assigns each
node to a specific example. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>batch_y</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots, B-1\}}^M\)</span>, which assigns each
node to a specific example. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cluster</span> <span class="o">=</span> <span class="n">nearest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-torch_geometric.nn.dense.diff_pool"></span><dl class="function">
<dt id="torch_geometric.nn.dense.diff_pool.dense_diff_pool">
<code class="descname">dense_diff_pool</code><span class="sig-paren">(</span><em>x</em>, <em>adj</em>, <em>s</em>, <em>mask=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/dense/diff_pool.html#dense_diff_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.dense.diff_pool.dense_diff_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Differentiable pooling operator from the <a class="reference external" href="https://arxiv.org/abs/1806.08804">“Hierarchical Graph
Representation Learning with Differentiable Pooling”</a> paper</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{X}^{\prime} &amp;= {\mathrm{softmax}(\mathbf{S})}^{\top} \cdot
\mathbf{X}\\\mathbf{A}^{\prime} &amp;= {\mathrm{softmax}(\mathbf{S})}^{\top} \cdot
\mathbf{A} \cdot \mathrm{softmax}(\mathbf{S})\end{aligned}\end{align} \]</div>
<p>based on dense learned assignments <span class="math notranslate nohighlight">\(\mathbf{S} \in \mathbb{R}^{B
\times N \times C}\)</span>.
Returns pooled node feature matrix, coarsened adjacency matrix and the
auxiliary link prediction objective <span class="math notranslate nohighlight">\(\| \mathbf{A} -
\mathrm{softmax}(\mathbf{S}) \cdot {\mathrm{softmax}(\mathbf{S})}^{\top}
\|_F\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature tensor <span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{B
\times N \times F}\)</span> with batch-size <span class="math notranslate nohighlight">\(B\)</span>, (maximum)
number of nodes <span class="math notranslate nohighlight">\(N\)</span> for each graph, and feature dimension
<span class="math notranslate nohighlight">\(F\)</span>.</li>
<li><strong>adj</strong> (<em>Tensor</em>) – Adjacency tensor <span class="math notranslate nohighlight">\(\mathbf{A} \in \mathbb{R}^{B
\times N \times N}\)</span>.</li>
<li><strong>s</strong> (<em>Tensor</em>) – Assignment tensor <span class="math notranslate nohighlight">\(\mathbf{S} \in \mathbb{R}^{B
\times N \times C}\)</span> with number of clusters <span class="math notranslate nohighlight">\(C\)</span>. The softmax
does not have to be applied beforehand, since it is executed
within this method.</li>
<li><strong>mask</strong> (<em>ByteTensor</em><em>, </em><em>optional</em>) – Mask matrix
<span class="math notranslate nohighlight">\(\mathbf{M} \in {\{ 0, 1 \}}^{B \times N}\)</span> indicating
the valid nodes for each graph. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-torch_geometric.nn.unpool">
<span id="unpooling-layers"></span><h2><a class="toc-backref" href="#id11">Unpooling Layers</a><a class="headerlink" href="#module-torch_geometric.nn.unpool" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="torch_geometric.nn.unpool.knn_interpolate">
<code class="descname">knn_interpolate</code><span class="sig-paren">(</span><em>x</em>, <em>pos_x</em>, <em>pos_y</em>, <em>batch_x=None</em>, <em>batch_y=None</em>, <em>k=3</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/unpool/knn_interpolate.html#knn_interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.unpool.knn_interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>The k-NN interpolation from the <a class="reference external" href="https://arxiv.org/abs/1706.02413">“PointNet++: Deep Hierarchical
Feature Learning on Point Sets in a Metric Space”</a> paper.
For each point <span class="math notranslate nohighlight">\(y\)</span> with position <span class="math notranslate nohighlight">\(\mathbf{p}(y)\)</span>, its
interpolated features <span class="math notranslate nohighlight">\(\mathbf{f}(y)\)</span> are given by</p>
<div class="math notranslate nohighlight">
\[\mathbf{f}(y) = \frac{\sum_{i=1}^k w(x_i) \mathbf{f}(x_i)}{\sum_{i=1}^k
w(x_i)} \textrm{, where } w(x_i) = \frac{1}{d(\mathbf{p}(y),
\mathbf{p}(x_i))^2}\]</div>
<p>and <span class="math notranslate nohighlight">\(\{ x_1, \ldots, x_k \}\)</span> denoting the <span class="math notranslate nohighlight">\(k\)</span> nearest points
to <span class="math notranslate nohighlight">\(y\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{N \times F}\)</span>.</li>
<li><strong>pos_x</strong> (<em>Tensor</em>) – Node position matrix
<span class="math notranslate nohighlight">\(\in \mathbb{R}^{N \times d}\)</span>.</li>
<li><strong>pos_y</strong> (<em>Tensor</em>) – Upsampled node position matrix
<span class="math notranslate nohighlight">\(\in \mathbb{R}^{M \times d}\)</span>.</li>
<li><strong>batch_x</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b_x} \in {\{ 0, \ldots, B-1\}}^N\)</span>, which assigns
each node from <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> to a specific example.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>batch_y</strong> (<em>LongTensor</em><em>, </em><em>optional</em>) – Batch vector
<span class="math notranslate nohighlight">\(\mathbf{b_y} \in {\{ 0, \ldots, B-1\}}^N\)</span>, which assigns
each node from <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span> to a specific example.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of neighbors. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">3</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-torch_geometric.nn.models">
<span id="models"></span><h2><a class="toc-backref" href="#id12">Models</a><a class="headerlink" href="#module-torch_geometric.nn.models" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch_geometric.nn.models.JumpingKnowledge">
<em class="property">class </em><code class="descname">JumpingKnowledge</code><span class="sig-paren">(</span><em>mode</em>, <em>channels=None</em>, <em>num_layers=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/jumping_knowledge.html#JumpingKnowledge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.JumpingKnowledge" title="Permalink to this definition">¶</a></dt>
<dd><p>The Jumping Knowledge layer aggregation module from the
<a class="reference external" href="https://arxiv.org/abs/1806.03536">“Representation Learning on Graphs with Jumping Knowledge Networks”</a> paper based on either
<strong>concatenation</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;cat&quot;</span></code>)</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}_v^{(1)} \, \Vert \, \ldots \, \Vert \, \mathbf{x}_v^{(T)}\]</div>
<p><strong>max pooling</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>)</p>
<div class="math notranslate nohighlight">
\[\max \left( \mathbf{x}_v^{(1)}, \ldots, \mathbf{x}_v^{(T)} \right)\]</div>
<p>or <strong>weighted summation</strong></p>
<div class="math notranslate nohighlight">
\[\sum_{t=1}^T \alpha_v^{(t)} \mathbf{x}_v^{(t)}\]</div>
<p>with attention scores <span class="math notranslate nohighlight">\(\alpha_v^{(t)}\)</span> obtained from a bi-directional
LSTM (<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;lstm&quot;</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mode</strong> (<em>string</em>) – The aggregation scheme to use
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;cat&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;lstm&quot;</span></code>).</li>
<li><strong>channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The number of channels per representation.
Needs to be only set for LSTM-style aggregation.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The number of layers to aggregate. Needs to
be only set for LSTM-style aggregation. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.models.JumpingKnowledge.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>xs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/jumping_knowledge.html#JumpingKnowledge.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.JumpingKnowledge.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregates representations across different layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>xs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – List containing layer-wise representations.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.JumpingKnowledge.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/jumping_knowledge.html#JumpingKnowledge.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.JumpingKnowledge.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.models.DeepGraphInfomax">
<em class="property">class </em><code class="descname">DeepGraphInfomax</code><span class="sig-paren">(</span><em>hidden_channels</em>, <em>encoder</em>, <em>summary</em>, <em>corruption</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/deep_graph_infomax.html#DeepGraphInfomax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.DeepGraphInfomax" title="Permalink to this definition">¶</a></dt>
<dd><p>The Deep Graph Infomax model from the
<a class="reference external" href="https://arxiv.org/abs/1809.10341">“Deep Graph Infomax”</a>
paper based on user-defined encoder and summary model <span class="math notranslate nohighlight">\(\mathcal{E}\)</span>
and <span class="math notranslate nohighlight">\(\mathcal{R}\)</span> respectively, and a corruption function
<span class="math notranslate nohighlight">\(\mathcal{C}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hidden_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The latent space dimensionality.</li>
<li><strong>encoder</strong> (<em>Module</em>) – The encoder module <span class="math notranslate nohighlight">\(\mathcal{E}\)</span>.</li>
<li><strong>summary</strong> (<em>callable</em>) – The readout function <span class="math notranslate nohighlight">\(\mathcal{R}\)</span>.</li>
<li><strong>corruption</strong> (<em>callable</em>) – The corruption function <span class="math notranslate nohighlight">\(\mathcal{C}\)</span>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.models.DeepGraphInfomax.discriminate">
<code class="descname">discriminate</code><span class="sig-paren">(</span><em>z</em>, <em>summary</em>, <em>sigmoid=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/deep_graph_infomax.html#DeepGraphInfomax.discriminate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.DeepGraphInfomax.discriminate" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the patch-summary pair <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>, computes
the probability scores assigned to this patch-summary pair.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>Tensor</em>) – The latent space.</li>
<li><strong>sigmoid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, does not apply
the logistic sigmoid function to the output.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.DeepGraphInfomax.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/deep_graph_infomax.html#DeepGraphInfomax.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.DeepGraphInfomax.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the latent space for the input arguments, their
corruptions and their summary representation.</p>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.DeepGraphInfomax.loss">
<code class="descname">loss</code><span class="sig-paren">(</span><em>pos_z</em>, <em>neg_z</em>, <em>summary</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/deep_graph_infomax.html#DeepGraphInfomax.loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.DeepGraphInfomax.loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the mutal information maximization objective.</p>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.DeepGraphInfomax.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/deep_graph_infomax.html#DeepGraphInfomax.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.DeepGraphInfomax.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.DeepGraphInfomax.test">
<code class="descname">test</code><span class="sig-paren">(</span><em>train_z</em>, <em>train_y</em>, <em>test_z</em>, <em>test_y</em>, <em>solver='lbfgs'</em>, <em>multi_class='auto'</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/deep_graph_infomax.html#DeepGraphInfomax.test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.DeepGraphInfomax.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates latent space quality via a logistic regression downstream
task.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.models.InnerProductDecoder">
<em class="property">class </em><code class="descname">InnerProductDecoder</code><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#InnerProductDecoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.InnerProductDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>The inner product decoder from the <a class="reference external" href="https://arxiv.org/abs/1611.07308">“Variational Graph Auto-Encoders”</a> paper</p>
<div class="math notranslate nohighlight">
\[\sigma(\mathbf{Z}\mathbf{Z}^{\top})\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{Z} \in \mathbb{R}^{N \times d}\)</span> denotes the latent
space produced by the encoder.</p>
<dl class="method">
<dt id="torch_geometric.nn.models.InnerProductDecoder.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>z</em>, <em>edge_index</em>, <em>sigmoid=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#InnerProductDecoder.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.InnerProductDecoder.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Decodes the latent variables <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code> into edge probabilties for
the given node-pairs <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>Tensor</em>) – The latent space <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span>.</li>
<li><strong>sigmoid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, does not apply
the logistic sigmoid function to the output.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.InnerProductDecoder.forward_all">
<code class="descname">forward_all</code><span class="sig-paren">(</span><em>z</em>, <em>sigmoid=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#InnerProductDecoder.forward_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.InnerProductDecoder.forward_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Decodes the latent variables <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code> into a probabilistic dense
adjacency matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>Tensor</em>) – The latent space <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span>.</li>
<li><strong>sigmoid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, does not apply
the logistic sigmoid function to the output.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.models.GAE">
<em class="property">class </em><code class="descname">GAE</code><span class="sig-paren">(</span><em>encoder</em>, <em>decoder=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#GAE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.GAE" title="Permalink to this definition">¶</a></dt>
<dd><p>The Graph Auto-Encoder model from the
<a class="reference external" href="https://arxiv.org/abs/1611.07308">“Variational Graph Auto-Encoders”</a>
paper based on user-defined encoder and decoder models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>encoder</strong> (<em>Module</em>) – The encoder module.</li>
<li><strong>decoder</strong> (<em>Module</em><em>, </em><em>optional</em>) – The decoder module. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>,
will default to the
<a class="reference internal" href="#torch_geometric.nn.models.InnerProductDecoder" title="torch_geometric.nn.models.InnerProductDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.nn.models.InnerProductDecoder</span></code></a>.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.models.GAE.decode">
<code class="descname">decode</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#GAE.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.GAE.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the decoder and computes edge probabilties.</p>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.GAE.encode">
<code class="descname">encode</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#GAE.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.GAE.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the encoder and computes node-wise latent variables.</p>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.GAE.recon_loss">
<code class="descname">recon_loss</code><span class="sig-paren">(</span><em>z</em>, <em>pos_edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#GAE.recon_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.GAE.recon_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Given latent variables <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code>, computes the binary cross
entropy loss for positive edges <code class="xref py py-obj docutils literal notranslate"><span class="pre">pos_edge_index</span></code> and negative
sampled edges.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>Tensor</em>) – The latent space <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span>.</li>
<li><strong>pos_edge_index</strong> (<em>LongTensor</em>) – The positive edges to train against.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.GAE.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#GAE.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.GAE.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.GAE.split_edges">
<code class="descname">split_edges</code><span class="sig-paren">(</span><em>data</em>, <em>val_ratio=0.05</em>, <em>test_ratio=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#GAE.split_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.GAE.split_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits the edges of a <a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code></a> object
into positve and negative train/val/test edges.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><em>Data</em></a>) – The data object.</li>
<li><strong>val_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – The ratio of positive validation
edges. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0.05</span></code>)</li>
<li><strong>test_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – The ratio of positive test
edges. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0.1</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.GAE.test">
<code class="descname">test</code><span class="sig-paren">(</span><em>z</em>, <em>pos_edge_index</em>, <em>neg_edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#GAE.test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.GAE.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Given latent variables <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code>, positive edges
<code class="xref py py-obj docutils literal notranslate"><span class="pre">pos_edge_index</span></code> and negative edges <code class="xref py py-obj docutils literal notranslate"><span class="pre">neg_edge_index</span></code>,
computes area under the ROC curve (AUC) and average precision (AP)
scores.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>Tensor</em>) – The latent space <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span>.</li>
<li><strong>pos_edge_index</strong> (<em>LongTensor</em>) – The positive edges to evaluate
against.</li>
<li><strong>neg_edge_index</strong> (<em>LongTensor</em>) – The negative edges to evaluate
against.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.models.VGAE">
<em class="property">class </em><code class="descname">VGAE</code><span class="sig-paren">(</span><em>encoder</em>, <em>decoder=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#VGAE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.VGAE" title="Permalink to this definition">¶</a></dt>
<dd><p>The Variational Graph Auto-Encoder model from the
<a class="reference external" href="https://arxiv.org/abs/1611.07308">“Variational Graph Auto-Encoders”</a>
paper.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>encoder</strong> (<em>Module</em>) – The encoder module to compute <span class="math notranslate nohighlight">\(\mu\)</span> and
<span class="math notranslate nohighlight">\(\log\sigma^2\)</span>.</li>
<li><strong>decoder</strong> (<em>Module</em><em>, </em><em>optional</em>) – The decoder module. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>,
will default to the
<a class="reference internal" href="#torch_geometric.nn.models.InnerProductDecoder" title="torch_geometric.nn.models.InnerProductDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.nn.models.InnerProductDecoder</span></code></a>.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.models.VGAE.encode">
<code class="descname">encode</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#VGAE.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.VGAE.encode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.VGAE.kl_loss">
<code class="descname">kl_loss</code><span class="sig-paren">(</span><em>mu=None</em>, <em>logvar=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#VGAE.kl_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.VGAE.kl_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the KL loss, either for the passed arguments <code class="xref py py-obj docutils literal notranslate"><span class="pre">mu</span></code>
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">logvar</span></code>, or based on latent variables from last encoding.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mu</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – The latent space for <span class="math notranslate nohighlight">\(\mu\)</span>. If set to
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, uses the last computation of <span class="math notranslate nohighlight">\(mu\)</span>.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>logvar</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – The latent space for
<span class="math notranslate nohighlight">\(\log\sigma^2\)</span>.  If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, uses the last
computation of <span class="math notranslate nohighlight">\(\log\sigma^2\)</span>.(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.VGAE.reparametrize">
<code class="descname">reparametrize</code><span class="sig-paren">(</span><em>mu</em>, <em>logvar</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#VGAE.reparametrize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.VGAE.reparametrize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.models.ARGA">
<em class="property">class </em><code class="descname">ARGA</code><span class="sig-paren">(</span><em>encoder</em>, <em>discriminator</em>, <em>decoder=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#ARGA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.ARGA" title="Permalink to this definition">¶</a></dt>
<dd><p>The Adversarially Regularized Graph Auto-Encoder model from the
<a class="reference external" href="https://arxiv.org/abs/1802.04407">“Adversarially Regularized Graph Autoencoder for Graph Embedding”</a> paper.
paper.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>encoder</strong> (<em>Module</em>) – The encoder module.</li>
<li><strong>discriminator</strong> (<em>Module</em>) – The discriminator module.</li>
<li><strong>decoder</strong> (<em>Module</em><em>, </em><em>optional</em>) – The decoder module. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>,
will default to the
<a class="reference internal" href="#torch_geometric.nn.models.InnerProductDecoder" title="torch_geometric.nn.models.InnerProductDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.nn.models.InnerProductDecoder</span></code></a>.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.models.ARGA.discriminator_loss">
<code class="descname">discriminator_loss</code><span class="sig-paren">(</span><em>z</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#ARGA.discriminator_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.ARGA.discriminator_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the loss of the discriminator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>z</strong> (<em>Tensor</em>) – The latent space <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.ARGA.reg_loss">
<code class="descname">reg_loss</code><span class="sig-paren">(</span><em>z</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#ARGA.reg_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.ARGA.reg_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the regularization loss of the encoder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>z</strong> (<em>Tensor</em>) – The latent space <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.ARGA.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#ARGA.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.ARGA.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.models.ARGVA">
<em class="property">class </em><code class="descname">ARGVA</code><span class="sig-paren">(</span><em>encoder</em>, <em>discriminator</em>, <em>decoder=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#ARGVA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.ARGVA" title="Permalink to this definition">¶</a></dt>
<dd><p>The Adversarially Regularized Variational Graph Auto-Encoder model from
the <a class="reference external" href="https://arxiv.org/abs/1802.04407">“Adversarially Regularized Graph Autoencoder for Graph Embedding”</a> paper.
paper.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>encoder</strong> (<em>Module</em>) – The encoder module to compute <span class="math notranslate nohighlight">\(\mu\)</span> and
<span class="math notranslate nohighlight">\(\log\sigma^2\)</span>.</li>
<li><strong>discriminator</strong> (<em>Module</em>) – The discriminator module.</li>
<li><strong>decoder</strong> (<em>Module</em><em>, </em><em>optional</em>) – The decoder module. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>,
will default to the
<a class="reference internal" href="#torch_geometric.nn.models.InnerProductDecoder" title="torch_geometric.nn.models.InnerProductDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.nn.models.InnerProductDecoder</span></code></a>.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.models.ARGVA.encode">
<code class="descname">encode</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#ARGVA.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.ARGVA.encode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.ARGVA.kl_loss">
<code class="descname">kl_loss</code><span class="sig-paren">(</span><em>mu=None</em>, <em>logvar=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#ARGVA.kl_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.ARGVA.kl_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.ARGVA.reparametrize">
<code class="descname">reparametrize</code><span class="sig-paren">(</span><em>mu</em>, <em>logvar</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/autoencoder.html#ARGVA.reparametrize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.ARGVA.reparametrize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.models.SignedGCN">
<em class="property">class </em><code class="descname">SignedGCN</code><span class="sig-paren">(</span><em>in_channels</em>, <em>hidden_channels</em>, <em>num_layers</em>, <em>lamb=5</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN" title="Permalink to this definition">¶</a></dt>
<dd><p>The signed graph convolutional network model from the <a class="reference external" href="https://arxiv.org/abs/1808.06354">“Signed Graph
Convolutional Network”</a> paper.
Internally, this module uses the
<a class="reference internal" href="#torch_geometric.nn.conv.SignedConv" title="torch_geometric.nn.conv.SignedConv"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.nn.conv.SignedConv</span></code></a> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of layers.</li>
<li><strong>lamb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Balances the contributions of the overall
objective. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">5</span></code>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, all layers will not
learn an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.models.SignedGCN.create_spectral_features">
<code class="descname">create_spectral_features</code><span class="sig-paren">(</span><em>pos_edge_index</em>, <em>neg_edge_index</em>, <em>num_nodes=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN.create_spectral_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN.create_spectral_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates <code class="xref py py-obj docutils literal notranslate"><span class="pre">in_channels</span></code> spectral node features based on
positive and negative edges.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pos_edge_index</strong> (<em>LongTensor</em>) – The positive edge indices.</li>
<li><strong>neg_edge_index</strong> (<em>LongTensor</em>) – The negative edge indices.</li>
<li><strong>num_nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The number of nodes, <em>i.e.</em>
<code class="xref py py-obj docutils literal notranslate"><span class="pre">max_val</span> <span class="pre">+</span> <span class="pre">1</span></code> of <code class="xref py py-attr docutils literal notranslate"><span class="pre">pos_edge_index</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">neg_edge_index</span></code>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.SignedGCN.discriminate">
<code class="descname">discriminate</code><span class="sig-paren">(</span><em>z</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN.discriminate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN.discriminate" title="Permalink to this definition">¶</a></dt>
<dd><p>Given node embeddings <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code>, classifies the link relation
between node pairs <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code> to be either positive,
negative or non-existent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>Tensor</em>) – The input node features.</li>
<li><strong>edge_index</strong> (<em>LongTensor</em>) – The edge indices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.SignedGCN.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>pos_edge_index</em>, <em>neg_edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes node embeddings <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code> based on positive edges
<code class="xref py py-obj docutils literal notranslate"><span class="pre">pos_edge_index</span></code> and negative edges <code class="xref py py-obj docutils literal notranslate"><span class="pre">neg_edge_index</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>Tensor</em>) – The input node features.</li>
<li><strong>pos_edge_index</strong> (<em>LongTensor</em>) – The positive edge indices.</li>
<li><strong>neg_edge_index</strong> (<em>LongTensor</em>) – The negative edge indices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.SignedGCN.loss">
<code class="descname">loss</code><span class="sig-paren">(</span><em>z</em>, <em>pos_edge_index</em>, <em>neg_edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN.loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN.loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the overall objective.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>Tensor</em>) – The node embeddings.</li>
<li><strong>pos_edge_index</strong> (<em>LongTensor</em>) – The positive edge indices.</li>
<li><strong>neg_edge_index</strong> (<em>LongTensor</em>) – The negative edge indices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.SignedGCN.neg_embedding_loss">
<code class="descname">neg_embedding_loss</code><span class="sig-paren">(</span><em>z</em>, <em>neg_edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN.neg_embedding_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN.neg_embedding_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the triplet loss between negative node pairs and sampled
non-node pairs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>Tensor</em>) – The node embeddings.</li>
<li><strong>neg_edge_index</strong> (<em>LongTensor</em>) – The negative edge indices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.SignedGCN.nll_loss">
<code class="descname">nll_loss</code><span class="sig-paren">(</span><em>z</em>, <em>pos_edge_index</em>, <em>neg_edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN.nll_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN.nll_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the discriminator loss based on node embeddings <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code>,
and positive edges <code class="xref py py-obj docutils literal notranslate"><span class="pre">pos_edge_index</span></code> and negative nedges
<code class="xref py py-obj docutils literal notranslate"><span class="pre">neg_edge_index</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>Tensor</em>) – The node embeddings.</li>
<li><strong>pos_edge_index</strong> (<em>LongTensor</em>) – The positive edge indices.</li>
<li><strong>neg_edge_index</strong> (<em>LongTensor</em>) – The negative edge indices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.SignedGCN.pos_embedding_loss">
<code class="descname">pos_embedding_loss</code><span class="sig-paren">(</span><em>z</em>, <em>pos_edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN.pos_embedding_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN.pos_embedding_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the triplet loss between positive node pairs and sampled
non-node pairs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>Tensor</em>) – The node embeddings.</li>
<li><strong>pos_edge_index</strong> (<em>LongTensor</em>) – The positive edge indices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.SignedGCN.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.SignedGCN.split_edges">
<code class="descname">split_edges</code><span class="sig-paren">(</span><em>edge_index</em>, <em>test_ratio=0.2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN.split_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN.split_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits the edges <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code> into train and test edges.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>edge_index</strong> (<em>LongTensor</em>) – The edge indices.</li>
<li><strong>test_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – The ratio of test edges.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0.2</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.SignedGCN.test">
<code class="descname">test</code><span class="sig-paren">(</span><em>z</em>, <em>pos_edge_index</em>, <em>neg_edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/signed_gcn.html#SignedGCN.test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.SignedGCN.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates node embeddings <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code> on positive and negative test
edges by computing AUC and F1 scores.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>Tensor</em>) – The node embeddings.</li>
<li><strong>pos_edge_index</strong> (<em>LongTensor</em>) – The positive edge indices.</li>
<li><strong>neg_edge_index</strong> (<em>LongTensor</em>) – The negative edge indices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.models.RENet">
<em class="property">class </em><code class="descname">RENet</code><span class="sig-paren">(</span><em>num_nodes</em>, <em>num_rels</em>, <em>hidden_channels</em>, <em>seq_len</em>, <em>num_layers=1</em>, <em>dropout=0</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/re_net.html#RENet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.RENet" title="Permalink to this definition">¶</a></dt>
<dd><p>The Recurrent Event Network model from the <a class="reference external" href="https://arxiv.org/abs/1904.05530">“Recurrent Event Network
for Reasoning over Temporal Knowledge Graphs”</a> paper</p>
<div class="math notranslate nohighlight">
\[f_{\mathbf{\Theta}}(\mathbf{e}_s, \mathbf{e}_r,
\mathbf{h}^{(t-1)}(s, r))\]</div>
<p>based on a RNN encoder</p>
<div class="math notranslate nohighlight">
\[\mathbf{h}^{(t)}(s, r) = \textrm{RNN}(\mathbf{e}_s, \mathbf{e}_r,
g(\mathcal{O}^{(t)}_r(s)), \mathbf{h}^{(t-1)}(s, r))\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{e}_s\)</span> and <span class="math notranslate nohighlight">\(\mathbf{e}_r\)</span> denote entity and
relation embeddings, and <span class="math notranslate nohighlight">\(\mathcal{O}^{(t)}_r(s)\)</span> represents the set
of objects interacted with subject <span class="math notranslate nohighlight">\(s\)</span> under relation <span class="math notranslate nohighlight">\(r\)</span> at
timestamp <span class="math notranslate nohighlight">\(t\)</span>.
This model implements <span class="math notranslate nohighlight">\(g\)</span> as the <strong>Mean Aggregator</strong> and
<span class="math notranslate nohighlight">\(f_{\mathbf{\Theta}}\)</span> as a linear projection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The number of nodes in the knowledge graph.</li>
<li><strong>num_rel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The number of relations in the knowledge graph.</li>
<li><strong>hidden_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Hidden size of node and relation embeddings.</li>
<li><strong>seq_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The sequence length of past events.</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The number of recurrent layers.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – If non-zero, introduces a dropout layer before the final
prediction. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0</span></code>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, all layers will not
learn an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.models.RENet.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/re_net.html#RENet.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.RENet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> batch, computes the forward pass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><em>torch_geometric.data.Data</em></a>) – The input data, holding subject
<code class="xref py py-obj docutils literal notranslate"><span class="pre">sub</span></code>, relation <code class="xref py py-obj docutils literal notranslate"><span class="pre">rel</span></code> and object <code class="xref py py-obj docutils literal notranslate"><span class="pre">obj</span></code>
information with shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">[batch_size]</span></code>.
In addition, <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> needs to hold history information for
subjects, given by a vector of node indices <code class="xref py py-obj docutils literal notranslate"><span class="pre">h_sub</span></code> and
their relative timestamps <code class="xref py py-obj docutils literal notranslate"><span class="pre">h_sub_t</span></code> and batch assignments
<code class="xref py py-obj docutils literal notranslate"><span class="pre">h_sub_batch</span></code>.
The same information must be given for objects (<code class="xref py py-obj docutils literal notranslate"><span class="pre">h_obj</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">h_obj_t</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">h_obj_batch</span></code>).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="torch_geometric.nn.models.RENet.pre_transform">
<em class="property">static </em><code class="descname">pre_transform</code><span class="sig-paren">(</span><em>seq_len</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/re_net.html#RENet.pre_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.RENet.pre_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Precomputes history objects</p>
<div class="math notranslate nohighlight">
\[\{ \mathcal{O}^{(t-k-1)}_r(s), \ldots, \mathcal{O}^{(t-1)}_r(s) \}\]</div>
<p>of a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.datasets.icews.EventDataset</span></code> with
<span class="math notranslate nohighlight">\(k\)</span> denoting the sequence length <code class="xref py py-obj docutils literal notranslate"><span class="pre">seq_len</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.RENet.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/re_net.html#RENet.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.RENet.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.models.RENet.test">
<code class="descname">test</code><span class="sig-paren">(</span><em>logits</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/models/re_net.html#RENet.test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.models.RENet.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Given ground-truth <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code>, computes Mean Reciprocal Rank (MRR)
and Hits at 1/3/10.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-torch_geometric.nn.data_parallel">
<span id="dataparallel-layers"></span><h2><a class="toc-backref" href="#id13">DataParallel layers</a><a class="headerlink" href="#module-torch_geometric.nn.data_parallel" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch_geometric.nn.data_parallel.DataParallel">
<em class="property">class </em><code class="descname">DataParallel</code><span class="sig-paren">(</span><em>module</em>, <em>device_ids=None</em>, <em>output_device=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/data_parallel.html#DataParallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.data_parallel.DataParallel" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements data parallelism at the module level.</p>
<p>This container parallelizes the application of the given <code class="xref py py-attr docutils literal notranslate"><span class="pre">module</span></code> by
splitting a list of <a class="reference internal" href="data.html#torch_geometric.data.Data" title="torch_geometric.data.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code></a> objects and copying
them as <a class="reference internal" href="data.html#torch_geometric.data.Batch" title="torch_geometric.data.Batch"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.data.Batch</span></code></a> objects to each device.
In the forward pass, the module is replicated on each device, and each
replica handles a portion of the input.
During the backwards pass, gradients from each replica are summed into the
original module.</p>
<p>The batch size should be larger than the number of GPUs used.</p>
<p>The parallelized <code class="xref py py-attr docutils literal notranslate"><span class="pre">module</span></code> must have its parameters and buffers on
<code class="xref py py-obj docutils literal notranslate"><span class="pre">device_ids[0]</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You need to use the <a class="reference internal" href="data.html#torch_geometric.data.DataListLoader" title="torch_geometric.data.DataListLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.data.DataListLoader</span></code></a> for
this module.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>module</strong> (<em>Module</em>) – Module to be parallelized.</li>
<li><strong>device_ids</strong> (<em>list of int</em><em> or </em><em>torch.device</em>) – CUDA devices.
(default: all devices)</li>
<li><strong>output_device</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>torch.device</em>) – Device location of output.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">device_ids[0]</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.data_parallel.DataParallel.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>data_list</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/data_parallel.html#DataParallel.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.data_parallel.DataParallel.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.data_parallel.DataParallel.scatter">
<code class="descname">scatter</code><span class="sig-paren">(</span><em>data_list</em>, <em>device_ids</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/data_parallel.html#DataParallel.scatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.data_parallel.DataParallel.scatter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data.html" class="btn btn-neutral float-right" title="torch_geometric.data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../notes/create_dataset.html" class="btn btn-neutral float-left" title="Creating your own datasets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Matthias Fey

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>